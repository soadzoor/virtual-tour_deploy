!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="src/",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function r(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function o(t,e,i,n){return new(i||(i=Promise))(function(r,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function s(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,s)}h((n=n.apply(t,e||[])).next())})}function a(t,e){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function s(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}var h,l=function(){function t(){}return Object.defineProperty(t,"DEFAULT_ZOOM_FACTOR",{get:function(){return t.MIN_ZOOM_FACTOR},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isFullscreenAvailable",{get:function(){var t=document.body;return!!(t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIOS",{get:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMac",{get:function(){return/Mac/.test(navigator.userAgent)&&!window.MSStream},enumerable:!0,configurable:!0}),Object.defineProperty(t,"browserName",{get:function(){return-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Chrome")?navigator.platform.indexOf("Mac")>-1?"Chrome - Mac":"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"IE":void 0},enumerable:!0,configurable:!0}),t.API_HOST="http://localhost:8080",t.SNACKBAR_AUTOHIDE_DURATION=6e3,t.TRANSITION_DURATION=400,t.ANIMATION_DURATION=2e3,t.FOV=75,t.POINTER_SENSITIVITY=1.2,t.MIN_ZOOM_FACTOR=1,t.WORLD_UP=[0,1,0],t.CAMERA_POSITION=[0,0,0],t.AUTOROTATION_SPEEDS={default:3e-5,fast:9e-4},t.MOUSE_BUTTON={LEFT:0,MIDDLE:1,RIGHT:2},t.clickThreshold={movement:3,time:1e3,longTap:1e3},t}(),c=function(){function t(){}return t.lengthOfSquared=function(t){var e,i,n=0;try{for(var r=s(t),o=r.next();!o.done;o=r.next()){var a=o.value;n+=a*a}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return n},t.lengthOf=function(e){return Math.sqrt(t.lengthOfSquared(e))},t.normalize=function(e){for(var i=t.lengthOf(e),n=0;n<e.length;++n)e[n]/=i;return e},t.dotProduct=function(t,e){for(var i=0,n=0;n<t.length;++n)i+=t[n]*e[n];return i},t.subVectors=function(t,e){for(var i=[],n=0;n<t.length;++n)i.push(t[n]-e[n]);return i},t.addVectors=function(t,e){for(var i=[],n=0;n<t.length;++n)i.push(t[n]+e[n]);return i},t.crossVectors=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},t.multiplyByScalar=function(t,e){for(var i=[],n=0;n<t.length;++n)i[n]=t[n]*e;return i},t.setFromMatrixPosition=function(t){var e=t.elements;return[e[12],e[13],e[14]]},t.distanceBetweenSquared=function(t,e){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return i*i+n*n+r*r},t.setQuaternionFromVector3=function(t){var e=Math.cos,i=Math.sin,n=e(t[0]/2),r=e(t[1]/2),o=e(t[2]/2),a=i(t[0]/2),s=i(t[1]/2),h=i(t[2]/2);return[a*r*o+n*s*h,n*s*o-a*r*h,n*r*h+a*s*o,n*r*o-a*s*h]},t.setFromRotationMatrix=function(t){var e,i,n,r,o,a=t.elements,s=a[0],h=a[4],l=a[8],c=a[1],u=a[5],d=a[9],p=a[2],m=a[6],_=a[10],f=s+u+_;return f>0?(i=.25/(e=.5/Math.sqrt(f+1)),n=(m-d)*e,r=(l-p)*e,o=(c-h)*e):s>u&&s>_?(i=(m-d)/(e=2*Math.sqrt(1+s-u-_)),n=.25*e,r=(h+c)/e,o=(l+p)/e):u>_?(i=(l-p)/(e=2*Math.sqrt(1+u-s-_)),n=(h+c)/e,r=.25*e,o=(d+m)/e):(i=(c-h)/(e=2*Math.sqrt(1+_-s-u)),n=(l+p)/e,r=(d+m)/e,o=.25*e),[n,r,o,i]},t.prototype.setFromMatrixPosition=function(t){var e=t.elements;return[e[12],e[13],e[14]]},t}(),u=function(){function t(){}return t.clamp=function(t,e,i){return t<=e?e:t>=i?i:t},t.isValidNumber=function(t){return null!==t&&void 0!==t&&!isNaN(t)&&t!==1/0&&t!==-1/0},t.deg2rad=function(t){return Math.PI/180*t},t.rad2deg=function(t){return 180/Math.PI*t},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.getForwardLengthFromFOV=function(e){return 1/Math.tan(t.deg2rad(e/2))},t.getNormalizedCursorCoords=function(t,e,i){return[2*(t/i[0]-.5),2*((i[1]-e)/i[1]-.5)]},t.getSphereSurfacePointFromUV=function(t,e){var i=[Math.cos(t)*Math.sin(e),Math.cos(e),Math.sin(t)*Math.sin(e)];return c.normalize(i)},t.getUVFromSphereSufracePoint=function(t){var e=c.normalize(t);return[1-(Math.PI-Math.atan2(e[2],e[0]))/(2*Math.PI),(Math.PI/2-Math.asin(-e[1]))/Math.PI]},t.getLongitudeLatitudeFromUV=function(t){return[2*Math.PI*((t[0]+.5)%1),Math.PI*(t[1]-.5)]},t}();!function(t){t[t.EASE_OUT=0]="EASE_OUT",t[t.EASE_IN_OUT=1]="EASE_IN_OUT"}(h||(h={}));var d=function(){function t(t,e,i,n,r){void 0===i&&(i=h.EASE_OUT),void 0===n&&(n=l.ANIMATION_DURATION),void 0===r&&(r=!0),this._timeStampAtSetEnd=0,this._min=-1/0,this._max=1/0,this._hasChanged=!1,this._prevDeltaValue=0,this._prevTimeStamp=1,this._prevDeltaTime=1,this._easing=h.EASE_OUT,this._timeoutId=-1,this._originalStart=t,this._start=t,this._originalEnd=e,this._end=e,this._value=this._start,this._originalAnimationDuration=this._animationDuration=n,this._easing=i,this._triggerRender=r}return t.removeFromActiveOnes=function(e){t._activeInstances=t._activeInstances.filter(function(t){return t!==e})},t.addToActiveOnes=function(e){t._activeInstances.includes(e)||t._activeInstances.push(e)},t.updateActiveOnes=function(e){var i,n,r=!1;try{for(var o=s(t._activeInstances),a=o.next();!a.done;a=o.next()){var h=a.value;r=r||h._triggerRender,h.update(e)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r},t.prototype.smoothStep=function(t){if(t<this._animationDuration){var e=t/this._animationDuration;return u.clamp(Math.pow(e,2)*(3-2*e)*(this._end-this._start)+this._start,this._min,this._max)}return this._end=u.clamp(this._end,this._min,this._max),this._end},t.prototype.exponentialOut=function(t){if(t<this._animationDuration){var e=t/this._animationDuration;return u.clamp((1-Math.pow(2,-10*e))*(1024/1023)*(this._end-this._start)+this._start,this._min,this._max)}return this._end=u.clamp(this._end,this._min,this._max),this._end},t.prototype.getNextValue=function(t){return this._easing===h.EASE_IN_OUT?this.smoothStep(t):this.exponentialOut(t)},t.prototype.increaseEndBy=function(t,e){void 0===e&&(e=!1),this.setEnd(this._end+t,e)},t.prototype.decreaseEndBy=function(t,e){void 0===e&&(e=!1),this.setEnd(this._end-t,e)},t.prototype.setEnd=function(e,i,n){var r=this;void 0===i&&(i=!1),void 0===n&&(n=this._originalAnimationDuration),this._animationDuration=n;var o=i?u.clamp(e,this._min,this._max):e;t.addToActiveOnes(this),this._start=this._value,this._end=o,this._timeStampAtSetEnd=D.timeStamp,i||(clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(function(){r._end=u.clamp(r._end,r._min,r._max)},this._animationDuration))},t.prototype.reset=function(e,i,n){void 0===n&&(n=this._originalAnimationDuration),this._animationDuration=n,t.addToActiveOnes(this),this._start=null!=e?e:this._originalStart,this._end=null!=i?i:this._originalEnd,this._timeStampAtSetEnd=D.timeStamp},t.prototype.update=function(e){this._prevDeltaTime=e-this._prevTimeStamp;var i=e-this._timeStampAtSetEnd,n=this._value;this._value=this.getNextValue(i),this._prevDeltaValue=this._value-n,this._prevTimeStamp=e,this._value===n?(this._start=this._end,this._hasChanged=!1,t.removeFromActiveOnes(this)):this._hasChanged=!0},Object.defineProperty(t.prototype,"animationDuration",{get:function(){return this._animationDuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalAnimationDuration",{get:function(){return this._originalAnimationDuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasChangedSinceLastTick",{get:function(){return this._hasChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prevDeltaValue",{get:function(){return this._prevDeltaValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prevDeltaTime",{get:function(){return this._prevDeltaTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"derivateAt0",{get:function(){return this._easing===h.EASE_OUT?6.938247437862991:0},enumerable:!0,configurable:!0}),t._activeInstances=[],t}(),p=function(t){function e(e,i,n,r,o,a,s){void 0===o&&(o=h.EASE_OUT),void 0===a&&(a=l.ANIMATION_DURATION),void 0===s&&(s=!0);var c=t.call(this,e,i,o,a,s)||this;return c._originalMin=c._min=n,c._originalMax=c._max=r,c}return r(e,t),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalMin",{get:function(){return this._originalMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalMax",{get:function(){return this._originalMax},enumerable:!0,configurable:!0}),e.prototype.setMin=function(e){this._min=e;var i=u.clamp(this._start,this._min,this._max),n=u.clamp(this._end,this._min,this._max);t.prototype.reset.call(this,i,n)},e.prototype.setMax=function(e){this._max=e;var i=u.clamp(this._start,this._min,this._max),n=u.clamp(this._end,this._min,this._max);t.prototype.reset.call(this,i,n)},e.prototype.reset=function(e,i,n,r,o){void 0===o&&(o=!1),this._min=null!=n?n:this._min,this._max=null!=r?r:this._max;var a=null!=e?e:this._originalStart,s=o?u.clamp(a,this._min,this._max):a,h=null!=i?i:this._originalEnd,l=o?u.clamp(h,this._min,this._max):h;t.prototype.reset.call(this,s,l)},e.prototype.isPlaying=function(){return this.value!==this.end},e}(d),m=function(){function t(){this._shouldPropagate=!0,this._bindings=[]}return t.create=function(){return new t},t.prototype.add=function(t,e,i){void 0===i&&(i=0),this.registerListener(t,!1,e,i)},t.prototype.addAndCall=function(t,e,i){void 0===i&&(i=0),this.registerListener(t,!1,e,i),e=e||this,t.call(e)},t.prototype.addOnce=function(t,e,i){void 0===i&&(i=0),this.registerListener(t,!0,e,i)},t.prototype.registerListener=function(t,e,i,n){void 0===n&&(n=0);var r=this.indexOfListener(t,i),o=null;if(-1!==r){if((o=this._bindings[r]).isOnce!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else o={listener:t,context:i,isOnce:e,priority:n},this.addBinding(o)},t.prototype.addBinding=function(t){var e=this._bindings.length;do{--e}while(this._bindings[e]&&t.priority<=this._bindings[e].priority);this._bindings.splice(e+1,0,t)},t.prototype.indexOfListener=function(t,e){for(var i=this._bindings.length-1;i>=0;--i){var n=this._bindings[i];if(n.listener===t&&n.context===e)return i}return-1},t.prototype.has=function(){},t.prototype.halt=function(){this._shouldPropagate=!1},t.prototype.remove=function(t,e){var i=this.indexOfListener(t,e);return-1!==i&&(this._bindings.splice(i,1),!0)},t.prototype.removeAll=function(){this._bindings.length=0},t.prototype.dispatch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=Array.prototype.slice.call(arguments);this._shouldPropagate=!0;for(var n=this._bindings,r=n.length-1;r>=0;--r){if(!1===n[r].listener.apply(n[r].context,i)||!this._shouldPropagate)break}},t.prototype.dispose=function(){this.removeAll()},Object.defineProperty(t.prototype,"bindings",{get:function(){return this._bindings},enumerable:!0,configurable:!0}),t}(),_=function(){function t(t,e){var i=this;this._isPointerDown=!1,this._mouseMoved=!0,this._pointer={downTimeStamp:null,startX:null,startY:null,prevX:null,prevY:null,prevDeltaX:0,prevDeltaY:0,prevTimeStamp:0,prevDeltaTime:1,triggerClickOnPointerUp:!1},this._u=new p(0,0,-1/0,1/0),this._v=new p(Math.PI/2,Math.PI/2,.01,3.14),this._pinch={startValue:{touchDistance:null,zoomValue:null},currentValue:{touchDistance:null,zoomValue:null}},this._forward=[-1,0,0],this._dampingTimeoutId=null,this._longTapTimeoutId=null,this._dampOnPointerUp=!1,this._prevSpeed=[],this._enabled=!1,this._autoRotation=[l.AUTOROTATION_SPEEDS.default,0],this.signals={click:m.create(),longTap:m.create()},this.ignorePinch=function(t){t.touches.length>1&&t.preventDefault(),(l.isIOS||l.isMac)&&1!==(t=t.originalEvent||t).scale&&t.preventDefault()},this.preventDefault=function(t){t.preventDefault()},this.onWheel=function(t){t.preventDefault();var e=i._sceneManager.userZoomFactor,n=Math.sign(-t.deltaY)>0?1.1*e.end:e.end/1.1;e.setEnd(n,!0)},this.onMouseDown=function(t){t.button===l.MOUSE_BUTTON.LEFT&&i.onPointerDown(t.clientX,t.clientY)},this.onTouchStart=function(t){t.preventDefault(),1===t.touches.length?i.onPointerDown(t.touches[0].clientX,t.touches[0].clientY):2===t.touches.length?(i._pinch.startValue.touchDistance=i.getTouchDistance(t),i._pinch.startValue.zoomValue=i._sceneManager.userZoomFactor.value):i.onPointerUp()},this.onMouseMove=function(t){i.onPointerMove(t.clientX,t.clientY)},this.onTouchMove=function(t){t.preventDefault(),1===t.touches.length?i.onPointerMove(t.touches[0].clientX,t.touches[0].clientY):2===t.touches.length&&i._pinch.startValue.touchDistance?(i._pinch.currentValue.touchDistance=i.getTouchDistance(t),i._pinch.currentValue.zoomValue=i._pinch.currentValue.touchDistance/i._pinch.startValue.touchDistance*i._pinch.startValue.zoomValue,i._sceneManager.userZoomFactor.setEnd(i._pinch.currentValue.zoomValue)):i.onPointerUp()},this.onPointerUp=function(){if(i._isPointerDown){var t=performance.now();i._domElement.classList.remove("rotating");var e=i._prevSpeed,n=c.lengthOfSquared(e);if(i._dampOnPointerUp&&!isNaN(n)&&0<n&&n<1/0){i._dampOnPointerUp=!1;var r=i._u.derivateAt0,o=i._u.originalAnimationDuration,a=[o*e[0]/r,o*e[1]/r];i._u.setEnd(i._u.value+a[0]),i._v.setEnd(i._v.value+a[1])}l.clickThreshold.time<t-i._pointer.downTimeStamp&&(i._pointer.triggerClickOnPointerUp=!1),i._pointer.triggerClickOnPointerUp&&i.signals.click.dispatch({clientX:i._pointer.prevX,clientY:i._pointer.prevY})}clearTimeout(i._longTapTimeoutId),i._isPointerDown=!1,i._pointer.triggerClickOnPointerUp=!1,i._pointer.downTimeStamp=null,i._pointer.startX=null,i._pointer.startY=null,i._pointer.prevX=null,i._pointer.prevY=null,i._pointer.prevTimeStamp=0,i._pointer.prevDeltaX=0,i._pointer.prevDeltaY=0,i._pointer.prevDeltaTime=1,i._pinch.startValue.touchDistance=i._pinch.startValue.zoomValue=i._pinch.currentValue.touchDistance=i._pinch.currentValue.zoomValue=null},this.cancelDamping=function(){i._dampOnPointerUp=!1},this._domElement=t,this._sceneManager=e,this.disableDefaultZoomGesture()}return t.prototype.disableDefaultZoomGesture=function(){window.addEventListener("touchstart",this.ignorePinch,{passive:!1}),window.addEventListener("touchmove",this.ignorePinch,{passive:!1}),window.addEventListener("gesturestart",this.preventDefault,{passive:!1}),window.addEventListener("gesturechange",this.preventDefault,{passive:!1})},t.prototype.getTouchDistance=function(t){var e=t.touches[0].clientX,i=t.touches[0].clientY,n=t.touches[1].clientX-e,r=t.touches[1].clientY-i;return Math.sqrt(n*n+r*r)},t.prototype.onPointerDown=function(t,e){var i=this;this.stopRotating(),this._isPointerDown=!0,this._mouseMoved=!1,this._pointer.startX=this._pointer.prevX=t,this._pointer.startY=this._pointer.prevY=e,this._pointer.downTimeStamp=performance.now(),this._pointer.prevTimeStamp=this._pointer.downTimeStamp,this._pointer.triggerClickOnPointerUp=!0,this._domElement.classList.add("rotating"),this._longTapTimeoutId=window.setTimeout(function(){i.signals.longTap.dispatch({clientX:t,clientY:e})},l.clickThreshold.longTap),this._u.reset(this._u.value,this._u.value),this._v.reset(this._v.value,this._v.value)},t.prototype.onPointerMove=function(t,e){if(this._isPointerDown&&(this._mouseMoved=t!==this._pointer.prevX||e!==this._pointer.prevY,this._mouseMoved)){if(this._domElement.classList.add("rotating"),null!=this._pointer.prevX&&null!=this._pointer.prevY){var i=this._sceneManager.userZoomFactor.value,n=(t-this._pointer.prevX)*l.POINTER_SENSITIVITY/window.innerHeight/i,r=(e-this._pointer.prevY)*l.POINTER_SENSITIVITY/window.innerHeight/i,o=this._u.end-n,a=this._v.end-r,s=this._pointer.startX-t,h=this._pointer.startY-e;(l.clickThreshold.movement<Math.abs(s)||l.clickThreshold.movement<Math.abs(h))&&(this._pointer.triggerClickOnPointerUp=!1,clearTimeout(this._longTapTimeoutId)),this._u.reset(o,o),this._v.reset(a,a)}this._pointer.prevDeltaX=t-this._pointer.prevX,this._pointer.prevDeltaY=e-this._pointer.prevY,this._pointer.prevX=t,this._pointer.prevY=e;var c=performance.now();l.clickThreshold.time<c-this._pointer.downTimeStamp&&(this._pointer.triggerClickOnPointerUp=!1),this._pointer.prevDeltaTime=c-this._pointer.prevTimeStamp,this._pointer.prevTimeStamp=c,this._dampOnPointerUp=!0,clearTimeout(this._dampingTimeoutId),this._dampingTimeoutId=setTimeout(this.cancelDamping,100)}},t.prototype.setUVFromSphereSufracePoint=function(t){var e=Math.PI+Math.atan2(-t[2],-t[0]);this._u.reset(e,e);var i=Math.PI/2-Math.asin(t[1]);this._v.reset(i,i)},t.prototype.setHeadingAngle=function(t,e,i){this._u.reset(t,t),e?this._v.reset(this._v.value,this._v.value):this._v.reset(Math.PI/2,Math.PI/2),i&&(this._autoRotation[0]=0,this._autoRotation[1]=0)},t.prototype.updateRotationLimit=function(){var t=this._viewBox;if(t){var e,i,n=this._domElement.offsetWidth/this._domElement.offsetHeight,r=u.deg2rad(l.FOV),o=2*Math.atan(Math.tan(r/2)*n);if(t[2]-t[0]<1){var a=!1,s=e=2*Math.PI*(-.5+t[0]),h=i=2*Math.PI*(-.5+t[2]);if(a&&(s+=o/2,h-=o/2),h>s)this._u.setMin(s),this._u.setMax(h);else{var c=(e+i)/2;this._u.setMin(c),this._u.setMax(c)}}else this._u.setMin(this._u.originalMin),this._u.setMax(this._u.originalMax);if(t[3]-t[1]<1)a=!1,s=e=t[1]*Math.PI,h=i=t[3]*Math.PI,a&&(s+=r/2,h-=r/2),h>s?(this._v.setMin(s),this._v.setMax(h)):(c=(e+i)/2,this._v.setMin(c),this._v.setMax(c));else this._v.setMin(this._v.originalMin),this._v.setMax(this._v.originalMax)}},t.prototype.limitRotation=function(t){this._viewBox=t,this.updateRotationLimit()},t.prototype.setSize=function(){this.updateRotationLimit()},t.prototype.activate=function(){this._enabled||(this._enabled=!0,this.setUVFromSphereSufracePoint(this._forward),this._domElement.addEventListener("mousedown",this.onMouseDown),this._domElement.addEventListener("touchstart",this.onTouchStart),this._domElement.addEventListener("wheel",this.onWheel),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("mouseup",this.onPointerUp),window.addEventListener("touchend",this.onPointerUp),window.addEventListener("touchcancel",this.onPointerUp))},t.prototype.deactivate=function(){this._enabled&&(this._enabled=!1,this._isPointerDown=!1,this._domElement.classList.remove("rotating"),this._domElement.removeEventListener("mousedown",this.onMouseDown),this._domElement.removeEventListener("touchstart",this.onTouchStart),this._domElement.removeEventListener("wheel",this.onWheel),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onPointerUp),window.removeEventListener("touchend",this.onPointerUp),window.removeEventListener("touchcancel",this.onPointerUp))},t.prototype.stopRotating=function(){this._autoRotation[0]=0,this._autoRotation[1]=0,this._u.reset(this._u.value,this._u.value),this._v.reset(this._v.value,this._v.value)},t.prototype.update=function(){return 0===this._autoRotation[0]&&0===this._autoRotation[1]||(this._u.reset(this._u.end+this._autoRotation[0]*D.deltaFrame,this._u.end+this._autoRotation[0]*D.deltaFrame),this._v.reset(this._v.end+this._autoRotation[1]*D.deltaFrame,this._v.end+this._autoRotation[1]*D.deltaFrame,void 0,void 0,!0)),(this._u.hasChangedSinceLastTick||this._v.hasChangedSinceLastTick)&&(this._prevSpeed[0]=this._u.prevDeltaValue/this._u.prevDeltaTime,this._prevSpeed[1]=this._v.prevDeltaValue/this._v.prevDeltaTime,this._forward=u.getSphereSurfacePointFromUV(this._u.value,this._v.value),this._sceneManager.needsRender=!0),this._forward},Object.defineProperty(t.prototype,"autoRotation",{get:function(){return this._autoRotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentHeadingAngle",{get:function(){var t=this._u.value%(2*Math.PI);return t<0?t+2*Math.PI:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forward",{get:function(){return this._forward},enumerable:!0,configurable:!0}),t}(),f=function(){function t(){}return Object.defineProperty(t,"vertexShader",{get:function(){return"precision highp float;\n\nattribute vec3 vertPosition;\n\nvarying vec3 vsRay;\nvarying vec3 movementDirection;\n\nuniform float zoomFactor;\nuniform vec3 fw;\nuniform float ratio;\n\nvoid main()\n{\n\tgl_Position = vec4(zoomFactor * vertPosition, 1.0);\n\n\tvec3 worldUp = vec3(0, 1, 0);\n\tvec3 camRight = normalize(cross(fw, worldUp));\n\tvec3 camUp = normalize(cross(camRight, fw));\n\tmovementDirection = normalize(cross(worldUp, camRight));\n\n\tvec3 corner = fw * "+u.getForwardLengthFromFOV(l.FOV)+" + ratio*camRight*vertPosition.x + camUp*vertPosition.y;\n\n\tvsRay = corner;\n}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fragmentShader",{get:function(){return"precision highp float;\n\n#define PI 3.14159265359\n#define SKY vec3(0.1, 0.1, 0.11)\n#define EPSILON 0.0001\n\nvarying vec3 vsRay;\nvarying vec3 movementDirection;\n\nuniform sampler2D texture;\nuniform vec4 textureViewBox;\nuniform float alpha;\nuniform float movementFactor;\n\n// Based on https://www.shadertoy.com/view/ldS3DW\n// But optimized (we're using the origo as center, and 1 as radius), + we're always inside the sphere\nfloat intersectSphere(vec3 ro, vec3 rd)\n{\n\tvec3 rc = ro;\n\tfloat c = dot(rc, rc) - 1.0;\n\tfloat b = dot(rd, rc);\n\tfloat d = b*b - c;\n\tfloat t = -b + sqrt(abs(d));\n\n\treturn t;\n}\n\nvec3 getColor(in sampler2D texture, in vec2 sphereUV, in vec4 textureViewBox)\n{\n\tif ((textureViewBox.x <= sphereUV.x && sphereUV.x <= textureViewBox.z) && (textureViewBox.y <= sphereUV.y && sphereUV.y <= textureViewBox.w))\n\t{\n\t\tvec2 imageUV = vec2(\n\t\t\t(sphereUV.x - textureViewBox.x) / (textureViewBox.z - textureViewBox.x),\n\t\t\t(sphereUV.y - textureViewBox.y) / (textureViewBox.w - textureViewBox.y)\n\t\t);\n\n\t\t// Anti-aliasing trick for the edge of the image\n\n\t\tfloat minX = abs(1.0 - (textureViewBox.z - textureViewBox.x)) < EPSILON ? 1.0 : min(abs(sphereUV.x - textureViewBox.x), abs(sphereUV.x - textureViewBox.z));\n\t\tfloat minY = abs(1.0 - (textureViewBox.w - textureViewBox.y)) < EPSILON ? 1.0 : min(abs(sphereUV.y - textureViewBox.y), abs(sphereUV.y - textureViewBox.w));\n\t\tfloat dist = min(minX, minY) * 2000.0;\n\n\t\tfloat factor = clamp(dist, 0.0, 1.0);\n\n\t\treturn mix(SKY, texture2D(texture, imageUV).rgb, factor);\n\n\t\t//return texture2D(texture, imageUV).rgb;\n\t}\n\telse\n\t{\n\t\treturn SKY;\n\t}\n}\n\nvoid main()\n{\n\tvec3 rayDirection = normalize(vsRay);\n\tvec3 rayOrigin = movementDirection * 0.1 * movementFactor;\n\n\tfloat t = intersectSphere(rayOrigin, rayDirection);\n\n\tvec3 hitPoint = rayOrigin + rayDirection * t;\n\n\tvec2 sphereUV = vec2(\n\t\t0.5 + atan(hitPoint.z, hitPoint.x) / (2.0 * PI),\n\t\t0.5 - asin(hitPoint.y) / PI\n\t);\n\n\tvec3 color = getColor(texture, sphereUV, textureViewBox);\n\n\tgl_FragColor = vec4(color, alpha);\n}"},enumerable:!0,configurable:!0}),t}(),g=function(){function t(t){this._isForwardLocked=!1,this._ratio={value:1,loc:null},this._zoomFactorLoc=null,this._movementFactor={convergence:new p(0,0,-1,1,h.EASE_IN_OUT,l.TRANSITION_DURATION),loc:null},this._forward={value:[0,0,-1],loc:null},this._texture={texValue:null,texLoc:null,viewBox:[0,0,1,1],viewBoxLoc:null},this._alpha={value:1,loc:null},this._isInitialTexture=!0,this._gl=t,this._vertexShader=t.createShader(t.VERTEX_SHADER),this._fragmentShader=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(this._vertexShader,f.vertexShader),t.shaderSource(this._fragmentShader,f.fragmentShader);try{this.compileShaders(),this.initProgram(),this._ratio.loc=this._gl.getUniformLocation(this._program,"ratio"),this._zoomFactorLoc=this._gl.getUniformLocation(this._program,"zoomFactor"),this._movementFactor.loc=this._gl.getUniformLocation(this._program,"movementFactor"),this._forward.loc=this._gl.getUniformLocation(this._program,"fw"),this._texture.texLoc=this._gl.getUniformLocation(this._program,"texture"),this._texture.viewBoxLoc=this._gl.getUniformLocation(this._program,"textureViewBox"),this._alpha.loc=this._gl.getUniformLocation(this._program,"alpha"),this.initTexture()}catch(t){console.error(t)}}return t.prototype.compileShaders=function(){this.compileShader(this._vertexShader),this.compileShader(this._fragmentShader)},t.prototype.compileShader=function(t){if(this._gl.compileShader(t),!this._gl.getShaderParameter(t,this._gl.COMPILE_STATUS))throw"Error compiling shader: "+this._gl.getShaderInfoLog(t)},t.prototype.initProgram=function(){this._program=this._gl.createProgram(),this._gl.attachShader(this._program,this._vertexShader),this._gl.attachShader(this._program,this._fragmentShader),this.linkProgram(),this.validateProgram()},t.prototype.linkProgram=function(){if(this._gl.linkProgram(this._program),!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)&&!this._gl.isContextLost())throw"Error linking program: "+this._gl.getError()+", "+this._gl.getProgramInfoLog(this._program)},t.prototype.validateProgram=function(){if(this._gl.validateProgram(this._program),!this._gl.getProgramParameter(this._program,this._gl.VALIDATE_STATUS))throw"Error validating program: "+this._gl.getProgramInfoLog(this._program)},t.prototype.setSize=function(t,e){this._ratio.value=t/e},t.prototype.initTexture=function(){this._texture.texValue=this._gl.createTexture();var t=new ImageData(1,1);this.loadTexture({textureData:t,viewBox:[0,0,1,1],headingAngle:0})},t.prototype.loadTexture=function(t){var e=this._texture;this._isInitialTexture&&(this._isInitialTexture=!1),e.viewBox=t.viewBox;var i=this._gl;i.bindTexture(i.TEXTURE_2D,e.texValue),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGB,i.RGB,i.UNSIGNED_BYTE,t.textureData),i.bindTexture(i.TEXTURE_2D,null)},t.prototype.fadeIn=function(){this._movementFactor.convergence.reset(-1,0)},t.prototype.fadeOut=function(){this._movementFactor.convergence.setEnd(1)},t.prototype.lockForward=function(){this._isForwardLocked=!0},t.prototype.unlockForward=function(){this._isForwardLocked=!1},t.prototype.resetZoom=function(){this._movementFactor.convergence.reset(0,0)},t.prototype.setVec3Uniform=function(t,e){this._gl.uniform3fv(t,e)},t.prototype.setVec4Uniform=function(t,e){this._gl.uniform4fv(t,e)},t.prototype.setFloatUniform=function(t,e){this._gl.uniform1f(t,e)},t.prototype.setTextureData=function(t,e){this._gl.activeTexture(this._gl.TEXTURE0+e),this._gl.bindTexture(this._gl.TEXTURE_2D,t.texValue),this._gl.uniform1i(t.texLoc,e)},t.prototype.setTexture=function(t,e){this.setVec4Uniform(t.viewBoxLoc,t.viewBox),this.setTextureData(t,e)},t.prototype.updateUniforms=function(t){this.setFloatUniform(this._ratio.loc,this._ratio.value),this.setVec3Uniform(this._forward.loc,this._forward.value),this.setFloatUniform(this._zoomFactorLoc,t),this.setFloatUniform(this._movementFactor.loc,this._movementFactor.convergence.value),this.setFloatUniform(this._alpha.loc,this._alpha.value),this.setTexture(this._texture,0)},t.prototype.render=function(t,e,i){e>0&&(this._isForwardLocked||(this._forward.value=t),this._alpha.value=e,this._gl.useProgram(this._program),this.updateUniforms(i),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,4))},Object.defineProperty(t.prototype,"program",{get:function(){return this._program},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultViewBox",{get:function(){return[0,0,1,1]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultTextureData",{get:function(){return{textureData:new ImageData(1,1),viewBox:this.defaultViewBox,headingAngle:0}},enumerable:!0,configurable:!0}),t}(),v=function(){function t(t,e){this._isInitialTexture=!0,this._mixFactor=new p(0,0,0,1,h.EASE_IN_OUT,l.TRANSITION_DURATION),this.onContextLost=function(t){t.preventDefault()},this._canvas=t,this._sceneManager=e}return t.prototype.init=function(){var t={alpha:!1,antialias:!1};return this._gl=this._canvas.getContext("webgl2",t)||this._canvas.getContext("experimental-webgl2",t)||this._canvas.getContext("webgl",t),!!this._gl&&(this._gl.clearColor(.125,.25,.5,1),this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight),this._gl.enable(this._gl.BLEND),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.DST_ALPHA),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._shader0=new g(this._gl),this._shader1=new g(this._gl),this._canvas.addEventListener("webglcontextlost",this.onContextLost),this.initGeometry(),this._gl.useProgram(this._shader0.program),!0)},Object.defineProperty(t.prototype,"maxTextureSize",{get:function(){var t;return null===(t=this._gl)||void 0===t?void 0:t.getParameter(this._gl.MAX_TEXTURE_SIZE)},enumerable:!0,configurable:!0}),t.prototype.setSize=function(t,e){if(this._gl){var i=window.devicePixelRatio,n=window.innerWidth*i,r=window.innerHeight*i;this._canvas.width=n,this._canvas.height=r,this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight),this._shader0.setSize(t,e),this._shader1.setSize(t,e),this._sceneManager.needsRender=!0}},t.prototype.initAttribPointer=function(t){this._gl.vertexAttribPointer(t,3,this._gl.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0)},t.prototype.initVertices=function(t){var e=this._gl.getAttribLocation(t,"vertPosition");this.initAttribPointer(e),this._gl.enableVertexAttribArray(e)},t.prototype.initGeometry=function(){var t=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]),this._gl.STATIC_DRAW),this.initVertices(this._shader0.program),this.initVertices(this._shader1.program)},t.prototype.loadDefaultTexture=function(){this.loadTexture(g.defaultTextureData)},t.prototype.loadTexture=function(t,e){var i=this;void 0===e&&(e=!1);var n=0;if(this._isInitialTexture)this._isInitialTexture=!1;else{var r=this._mixFactor.end;n=1===r?0:1}var o=0===n?this._shader1:this._shader0,a=0===n?this._shader0:this._shader1;o.lockForward(),a.unlockForward(),a.loadTexture(t),e||(o.resetZoom(),a.resetZoom()),requestAnimationFrame(function(){i._mixFactor.setEnd(n),e&&(o.fadeOut(),a.fadeIn())})},t.prototype.render=function(t,e){this._shader0.render(t,1-this._mixFactor.value,e),this._shader1.render(t,this._mixFactor.value,e)},t}(),y=function(){function t(){}return t.lengthOfSquared=function(t){var e,i,n=0;try{for(var r=s(t),o=r.next();!o.done;o=r.next()){var a=o.value;n+=a*a}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return n},t.lengthOf=function(e){return Math.sqrt(t.lengthOfSquared(e))},t.normalize=function(e){for(var i=t.lengthOf(e),n=0;n<e.length;++n)e[n]/=i;return e},t.subVectors=function(t,e){for(var i=[],n=0;n<t.length;++n)i.push(t[n]-e[n]);return i},t.crossVectors=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},t.multiplyByScalar=function(t,e){for(var i=[],n=0;n<t.length;++n)i[n]=t[n]*e;return i},t.getSphereSurfacePointFromUV=function(e,i){var n=[Math.cos(e)*Math.sin(i),Math.cos(i),Math.sin(e)*Math.sin(i)];return t.normalize(n)},t.setFromMatrixPosition=function(t){var e=t.elements;return[e[12],e[13],e[14]]},t.distanceBetweenSquared=function(t,e){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return i*i+n*n+r*r},t.setQuaternionFromVector3=function(t){var e=Math.cos,i=Math.sin,n=e(t[0]/2),r=e(t[1]/2),o=e(t[2]/2),a=i(t[0]/2),s=i(t[1]/2),h=i(t[2]/2);return[a*r*o+n*s*h,n*s*o-a*r*h,n*r*h+a*s*o,n*r*o-a*s*h]},t.setFromRotationMatrix=function(t){var e,i,n,r,o,a=t.elements,s=a[0],h=a[4],l=a[8],c=a[1],u=a[5],d=a[9],p=a[2],m=a[6],_=a[10],f=s+u+_;return f>0?(i=.25/(e=.5/Math.sqrt(f+1)),n=(m-d)*e,r=(l-p)*e,o=(c-h)*e):s>u&&s>_?(i=(m-d)/(e=2*Math.sqrt(1+s-u-_)),n=.25*e,r=(h+c)/e,o=(l+p)/e):u>_?(i=(l-p)/(e=2*Math.sqrt(1+u-s-_)),n=(h+c)/e,r=.25*e,o=(d+m)/e):(i=(c-h)/(e=2*Math.sqrt(1+_-s-u)),n=(l+p)/e,r=(d+m)/e,o=.25*e),[n,r,o,i]},t.prototype.setFromMatrixPosition=function(t){var e=t.elements;return[e[12],e[13],e[14]]},t}(),b=function(){function t(){this._elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return t.prototype.set=function(t,e,i,n,r,o,a,s,h,l,c,u,d,p,m,_){var f=this._elements;return f[0]=t,f[4]=e,f[8]=i,f[12]=n,f[1]=r,f[5]=o,f[9]=a,f[13]=s,f[2]=h,f[6]=l,f[10]=c,f[14]=u,f[3]=d,f[7]=p,f[11]=m,f[15]=_,this},t.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.prototype.copy=function(t){var e=this._elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},t.prototype.copyPosition=function(t){var e=this._elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},t.prototype.transpose=function(){var t,e=this._elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},t.prototype.scale=function(t){var e=this._elements,i=t[0],n=t[1],r=t[2];return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},t.prototype.multiplyMatrices=function(t,e){var i=t.elements,n=e.elements,r=this._elements,o=i[0],a=i[4],s=i[8],h=i[12],l=i[1],c=i[5],u=i[9],d=i[13],p=i[2],m=i[6],_=i[10],f=i[14],g=i[3],v=i[7],y=i[11],b=i[15],x=n[0],w=n[4],S=n[8],T=n[12],P=n[1],M=n[5],E=n[9],O=n[13],I=n[2],L=n[6],F=n[10],A=n[14],D=n[3],U=n[7],R=n[11],C=n[15];return r[0]=o*x+a*P+s*I+h*D,r[4]=o*w+a*M+s*L+h*U,r[8]=o*S+a*E+s*F+h*R,r[12]=o*T+a*O+s*A+h*C,r[1]=l*x+c*P+u*I+d*D,r[5]=l*w+c*M+u*L+d*U,r[9]=l*S+c*E+u*F+d*R,r[13]=l*T+c*O+u*A+d*C,r[2]=p*x+m*P+_*I+f*D,r[6]=p*w+m*M+_*L+f*U,r[10]=p*S+m*E+_*F+f*R,r[14]=p*T+m*O+_*A+f*C,r[3]=g*x+v*P+y*I+b*D,r[7]=g*w+v*M+y*L+b*U,r[11]=g*S+v*E+y*F+b*R,r[15]=g*T+v*O+y*A+b*C,this},t.prototype.makePerspective=function(t,e,i,n,r,o){var a=this._elements,s=2*r/(e-t),h=2*r/(i-n),l=(e+t)/(e-t),c=(i+n)/(i-n),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=h,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},t.prototype.makeOrthographic=function(t,e,i,n,r,o){var a=this.elements,s=1/(e-t),h=1/(i-n),l=1/(o-r),c=(e+t)*s,u=(i+n)*h,d=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},t.prototype.getInverse=function(t){var e=this._elements,i=t.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],h=i[5],l=i[6],c=i[7],u=i[8],d=i[9],p=i[10],m=i[11],_=i[12],f=i[13],g=i[14],v=i[15],y=d*g*c-f*p*c+f*l*m-h*g*m-d*l*v+h*p*v,b=_*p*c-u*g*c-_*l*m+s*g*m+u*l*v-s*p*v,x=u*f*c-_*d*c+_*h*m-s*f*m-u*h*v+s*d*v,w=_*d*l-u*f*l-_*h*p+s*f*p+u*h*g-s*d*g,S=n*y+r*b+o*x+a*w;if(0===S)return console.warn("Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity();var T=1/S;return e[0]=y*T,e[1]=(f*p*a-d*g*a-f*o*m+r*g*m+d*o*v-r*p*v)*T,e[2]=(h*g*a-f*l*a+f*o*c-r*g*c-h*o*v+r*l*v)*T,e[3]=(d*l*a-h*p*a-d*o*c+r*p*c+h*o*m-r*l*m)*T,e[4]=b*T,e[5]=(u*g*a-_*p*a+_*o*m-n*g*m-u*o*v+n*p*v)*T,e[6]=(_*l*a-s*g*a-_*o*c+n*g*c+s*o*v-n*l*v)*T,e[7]=(s*p*a-u*l*a+u*o*c-n*p*c-s*o*m+n*l*m)*T,e[8]=x*T,e[9]=(_*d*a-u*f*a-_*r*m+n*f*m+u*r*v-n*d*v)*T,e[10]=(s*f*a-_*h*a+_*r*c-n*f*c-s*r*v+n*h*v)*T,e[11]=(u*h*a-s*d*a-u*r*c+n*d*c+s*r*m-n*h*m)*T,e[12]=w*T,e[13]=(u*f*o-_*d*o+_*r*p-n*f*p-u*r*g+n*d*g)*T,e[14]=(_*h*o-s*f*o-_*r*l+n*f*l+s*r*g-n*h*g)*T,e[15]=(s*d*o-u*h*o+u*r*l-n*d*l-s*r*p+n*h*p)*T,this},t.prototype.compose=function(t,e,i){var n=this._elements,r=e[0],o=e[1],a=e[2],s=e[3],h=r+r,l=o+o,c=a+a,u=r*h,d=r*l,p=r*c,m=o*l,_=o*c,f=a*c,g=s*h,v=s*l,y=s*c,b=i[0],x=i[1],w=i[2];return n[0]=(1-(m+f))*b,n[1]=(d+y)*b,n[2]=(p-v)*b,n[3]=0,n[4]=(d-y)*x,n[5]=(1-(u+f))*x,n[6]=(_+g)*x,n[7]=0,n[8]=(p+v)*w,n[9]=(_-g)*w,n[10]=(1-(u+m))*w,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,this},t.prototype.lookAt=function(t,e,i){var n=this._elements,r=y.subVectors(t,e),o=y.crossVectors(i,r);o=y.normalize(o);var a=y.crossVectors(r,o);return n[0]=o[0],n[4]=a[0],n[8]=r[0],n[1]=o[1],n[5]=a[1],n[9]=r[1],n[2]=o[2],n[6]=a[2],n[10]=r[2],this},Object.defineProperty(t.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),t}(),x=function(){function t(){this._parent=null,this._children=[],this._position=[0,0,0],this._quaternion=[0,0,0,1],this._scale=[1,1,1],this._matrix=new b,this._matrixWorldNeedsUpdate=!0,this._matrixWorld=new b,this._target=[0,0,-1],this._up=[0,1,0],this._m1=new b}return t.prototype.setPosition=function(t,e){void 0===e&&(e=!0),this._position=t,e&&(this.updateMatrix(),this.updateMatrixWorld())},t.prototype.setScale=function(t,e){void 0===e&&(e=!0),this._scale=t,e&&(this.updateMatrix(),this.updateMatrixWorld())},t.prototype.updateMatrix=function(){this._matrix.compose(this._position,this._quaternion,this.scale),this._matrixWorldNeedsUpdate=!0},t.prototype.updateMatrixWorld=function(t){var e,i;void 0===t&&(t=!0),(this.matrixWorldNeedsUpdate||t)&&(null===this._parent?this.matrixWorld.copy(this._matrix):this.matrixWorld.multiplyMatrices(this._parent.matrixWorld,this._matrix),this._matrixWorldNeedsUpdate=!1,t=!0);try{for(var n=s(this._children),r=n.next();!r.done;r=n.next())r.value.updateMatrixWorld(t)}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},t.prototype.updateWorldMatrix=function(t,e){var i,n,r=this._parent;if(t&&null!==r&&r.updateWorldMatrix(!0,!1),this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this._matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this._matrix),e)try{for(var o=s(this.children),a=o.next();!a.done;a=o.next())a.value.updateWorldMatrix(!1,!0)}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}},t.prototype.add=function(t){return null!==t._parent&&t._parent.remove(t),t._parent=this,this.children.push(t),this},t.prototype.remove=function(t){var e=this.children.indexOf(t);return-1!==e&&(t._parent=null,this.children.splice(e,1)),this},t.prototype.traverse=function(t){var e,i;t(this);try{for(var n=s(this._children),r=n.next();!r.done;r=n.next())r.value.traverse(t)}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},t.prototype.lookAt=function(t){this._target[0]=t[0],this._target[1]=t[1],this._target[2]=t[2],this.updateWorldMatrix(!0,!1),this._position=y.setFromMatrixPosition(this._matrixWorld),this._m1.lookAt(this._position,this._target,this._up),this._quaternion=y.setFromRotationMatrix(this._m1)},Object.defineProperty(t.prototype,"matrixWorldNeedsUpdate",{get:function(){return this._matrixWorldNeedsUpdate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"matrixWorld",{get:function(){return this._matrixWorld},enumerable:!0,configurable:!0}),t}(),w=function(t){function e(){var e=t.call(this)||this;return e._matrixWorldInverse=new b,e._projectionMatrix=new b,e._projectionMatrixInverse=new b,e}return r(e,t),e.prototype.updateMatrixWorld=function(e){void 0===e&&(e=!0),t.prototype.updateMatrixWorld.call(this,e),this._matrixWorldInverse.getInverse(this._matrixWorld)},Object.defineProperty(e.prototype,"matrixWorldInverse",{get:function(){return this._matrixWorldInverse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projectionMatrix",{get:function(){return this._projectionMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projectionMatrixInverse",{get:function(){return this._projectionMatrixInverse},enumerable:!0,configurable:!0}),e}(x),S=function(t){function e(e,i,n,r,o){void 0===o&&(o=1);var a=t.call(this)||this;return a._fov=e,a._aspect=i,a._near=n,a._far=r,a._zoom=o,a.updateProjectionMatrix(),a}return r(e,t),e.prototype.setZoom=function(t){this._zoom=t},e.prototype.setAspect=function(t){this._aspect=t},e.prototype.updateProjectionMatrix=function(){var t=this._near,e=t*Math.tan(u.deg2rad(.5*this._fov))/this._zoom,i=2*e,n=this._aspect*i,r=-.5*n;this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this._far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},e}(w),T=function(t){function e(e,i,n,r,o,a){var s=t.call(this)||this;return s._right=0,s._left=0,s._top=0,s._bottom=0,s._near=0,s._far=2,s._zoom=1,s._left=e,s._right=i,s._top=n,s._bottom=r,s._near=o,s._far=a,s}return r(e,t),e.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this._zoom),e=(this.top-this.bottom)/(2*this._zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,o=i+t,a=n+e,s=n-e;this._projectionMatrix.makeOrthographic(r,o,a,s,this._near,this._far),this._projectionMatrixInverse.getInverse(this.projectionMatrix)},Object.defineProperty(e.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._bottom},enumerable:!0,configurable:!0}),e}(w),P=function(t){function e(e){var i=t.call(this)||this;return i._element=e,i._element.style.position="absolute",i._element.style.pointerEvents="auto",i}return r(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e}(x),M=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.setOriginalPosition=function(t){this._originalPosition=t},Object.defineProperty(e.prototype,"originalPosition",{get:function(){return this._originalPosition},enumerable:!0,configurable:!0}),e}(P),E=function(){function t(){var t=this;this._calc1=[],this._calc2=[],this._isIE=/Trident/i.test(navigator.userAgent),this.getDistanceToSquared=function(e,i){return t._calc1=y.setFromMatrixPosition(e.matrixWorld),t._calc2=y.setFromMatrixPosition(i.matrixWorld),y.distanceBetweenSquared(t._calc1,t._calc2)},this._matrix=new b,this._cache={camera:{fov:0,style:""},objects:new WeakMap},this._domElement=document.createElement("div"),this._domElement.style.overflow="hidden",this._cameraElement=document.createElement("div"),this._cameraElement.style.transformStyle="preserve-3d",this._cameraElement.style.pointerEvents="none",this._domElement.appendChild(this._cameraElement)}return Object.defineProperty(t.prototype,"domElement",{get:function(){return this._domElement},enumerable:!0,configurable:!0}),t.prototype.getSize=function(){return{width:this._width,height:this._height}},t.prototype.setSize=function(t,e){this._width=t,this._height=e,this._widthHalf=t/2,this._heightHalf=e/2,this._domElement.style.width=t+"px",this._domElement.style.height=e+"px",this._cameraElement.style.width=t+"px",this._cameraElement.style.height=e+"px"},t.prototype.epsilon=function(t){return Math.abs(t)<1e-10?0:t},t.prototype.getCameraCSSMatrix=function(t){var e=t.elements;return"matrix3d(\n\t\t\t"+this.epsilon(e[0])+",\n\t\t\t"+this.epsilon(-e[1])+",\n\t\t\t"+this.epsilon(e[2])+",\n\t\t\t"+this.epsilon(e[3])+",\n\t\t\t"+this.epsilon(e[4])+",\n\t\t\t"+this.epsilon(-e[5])+",\n\t\t\t"+this.epsilon(e[6])+",\n\t\t\t"+this.epsilon(e[7])+",\n\t\t\t"+this.epsilon(e[8])+",\n\t\t\t"+this.epsilon(-e[9])+",\n\t\t\t"+this.epsilon(e[10])+",\n\t\t\t"+this.epsilon(e[11])+",\n\t\t\t"+this.epsilon(e[12])+",\n\t\t\t"+this.epsilon(-e[13])+",\n\t\t\t"+this.epsilon(e[14])+",\n\t\t\t"+this.epsilon(e[15])+"\n\t\t)"},t.prototype.getObjectCSSMatrix=function(t,e){var i=t.elements,n="matrix3d(\n\t\t\t"+this.epsilon(i[0])+",\n\t\t\t"+this.epsilon(i[1])+",\n\t\t\t"+this.epsilon(i[2])+",\n\t\t\t"+this.epsilon(i[3])+",\n\t\t\t"+this.epsilon(-i[4])+",\n\t\t\t"+this.epsilon(-i[5])+",\n\t\t\t"+this.epsilon(-i[6])+",\n\t\t\t"+this.epsilon(-i[7])+",\n\t\t\t"+this.epsilon(i[8])+",\n\t\t\t"+this.epsilon(i[9])+",\n\t\t\t"+this.epsilon(i[10])+",\n\t\t\t"+this.epsilon(i[11])+",\n\t\t\t"+this.epsilon(i[12])+",\n\t\t\t"+this.epsilon(i[13])+",\n\t\t\t"+this.epsilon(i[14])+",\n\t\t\t"+this.epsilon(i[15])+"\n\t\t)";return this._isIE?"translate(-50%,-50%) translate("+this._widthHalf+"px, "+this._heightHalf+"px) "+e+" "+n:"translate(-50%,-50%) "+n},t.prototype.renderObject=function(t,e,i){var n,r;if(t instanceof P){var o=void 0;t instanceof M?(this._matrix.copy(e.matrixWorldInverse),this._matrix.transpose(),this._matrix.copyPosition(t.matrixWorld),this._matrix.scale(t.scale),this._matrix.elements[3]=0,this._matrix.elements[7]=0,this._matrix.elements[11]=0,this._matrix.elements[15]=1,o=this.getObjectCSSMatrix(this._matrix,i)):o=this.getObjectCSSMatrix(t.matrixWorld,i);var a=t.element,h=this._cache.objects.get(t);if(void 0===h||h.style!==o){a.style.transform=o;var l={style:o,distanceToCameraSquared:null};this._isIE&&(l.distanceToCameraSquared=this.getDistanceToSquared(e,t)),this._cache.objects.set(t,l)}a.parentNode!==this._cameraElement&&this._cameraElement.appendChild(a)}try{for(var c=s(t.children),u=c.next();!u.done;u=c.next()){var d=u.value;this.renderObject(d,e,i)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},t.prototype.filterAndFlatten=function(t){var e=[];return t.traverse(function(t){t instanceof P&&e.push(t)}),e},t.prototype.zOrder=function(t){for(var e=this,i=this.filterAndFlatten(t).sort(function(t,i){return e._cache.objects.get(t).distanceToCameraSquared-e._cache.objects.get(i).distanceToCameraSquared}),n=i.length,r=0;r<i.length;++r)i[r].element.style.zIndex=(n-r).toString()},t.prototype.render=function(t,e){var i=e.projectionMatrix.elements[5]*this._heightHalf;this._cache.camera.fov!==i&&(this._domElement.style.perspective=e instanceof S?i+"px":"",this._cache.camera.fov=i),t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(!1);var n=0,r=0;e instanceof T&&(n=-(e.right+e.left)/2,r=(e.top+e.bottom)/2);var o=e instanceof T?"scale("+i+")translate("+this.epsilon(n)+"px,"+this.epsilon(r)+"px)"+this.getCameraCSSMatrix(e.matrixWorldInverse):"translateZ("+i+"px)"+this.getCameraCSSMatrix(e.matrixWorldInverse),a=o+"translate("+this._widthHalf+"px, "+this._heightHalf+"px)";this._cache.camera.style===a||this._isIE||(this._cameraElement.style.transform=a,this._cache.camera.style=a),this.renderObject(t,e,o),this._isIE&&this.zOrder(t)},t}(),O=function(t){function e(){var e=t.call(this)||this;return e.type="Scene",e}return r(e,t),e}(x),I=function(){function t(t,e){this._renderer=new E,this._scene=new O,this._userZoomFactor=1,this._scaleFactor=new p(1,1,l.MIN_ZOOM_FACTOR/l.DEFAULT_ZOOM_FACTOR,l.DEFAULT_ZOOM_FACTOR,h.EASE_IN_OUT,l.TRANSITION_DURATION),this._camera=new S(l.FOV,1,.5,2,1),this._isForwardLocked=!1,this._hotSpots=[],this._sceneManager=e,this._renderer.domElement.style.position="absolute",this._renderer.domElement.style.top="0",this._renderer.domElement.style.left="0",t.parentElement.appendChild(this._renderer.domElement)}return t.prototype.clearScene=function(){var t,e;try{for(var i=s(this._hotSpots),n=i.next();!n.done;n=i.next())n.value.destroy()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this._hotSpots.length=0,this._scene.children.length=0},t.prototype.fade=function(){var t=this;this._renderer.domElement.style.zIndex="0",this._isForwardLocked=!0;var e=this._scaleFactor.end;this._scaleFactor.reset(l.MIN_ZOOM_FACTOR,l.DEFAULT_ZOOM_FACTOR),this.addClassNameToHotSpots("invisible"),setTimeout(function(){t.clearScene(),t._scaleFactor.reset(e,e)},l.TRANSITION_DURATION)},t.prototype.createHotSpot=function(t,e){this.makeHotSpot(t,e),this.resizeHotSpots(),this._sceneManager.needsRender=!0},t.prototype.makeHotSpot=function(t,e){var i=this,n=t.createObject3D();t.signals.click.add(function(){var n=i.photoSpheres[t.photoSphere.index].transitions.find(function(t){return t.toPanoramaId===i._sceneManager.photoSphereID});e(t.photoSphere.index,n?n.longitude+Math.PI:null,!0)}),this._hotSpots.push(t),this._scene.add(n)},t.prototype.updateHotSpots=function(t,e,i){var n,r,o=this;void 0===i&&(i=!1),this._isForwardLocked=!1,this._renderer.domElement.style.zIndex="1";try{for(var a=s(t),h=a.next();!h.done;h=a.next()){var l=h.value;this.makeHotSpot(l,e)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}i&&this.playMovementEffect(),this.addClassNameToHotSpots("invisible"),requestAnimationFrame(function(){requestAnimationFrame(function(){o.removeClassNameFromHotSpots("invisible")})}),this.resizeHotSpots()},t.prototype.resizeHotSpots=function(t){var e,i;void 0===t&&(t=1);try{for(var n=s(this._hotSpots),r=n.next();!r.done;r=n.next())r.value.resize(t)}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},t.prototype.setSize=function(t,e){this._renderer.setSize(t,e),this._camera.setAspect(t/e),this._camera.updateProjectionMatrix(),this.resizeHotSpots()},t.prototype.addClassNameToHotSpots=function(t){var e,i;try{for(var n=s(this._htmlElements),r=n.next();!r.done;r=n.next())r.value.classList.add(t)}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},t.prototype.removeClassNameFromHotSpots=function(t){var e,i;try{for(var n=s(this._htmlElements),r=n.next();!r.done;r=n.next())r.value.classList.remove(t)}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},t.prototype.playMovementEffect=function(){this._scaleFactor.reset(this._scaleFactor.min,l.MIN_ZOOM_FACTOR)},t.prototype.render=function(t,e){var i=this._userZoomFactor!==e;this._isForwardLocked&&null!=this._forward||(this._forward=t,this._userZoomFactor=e),i&&(this._camera.setZoom(this._userZoomFactor),this._camera.updateProjectionMatrix()),(this._scaleFactor.hasChangedSinceLastTick||i)&&this.resizeHotSpots(this._scaleFactor.value),this._camera.lookAt(this._forward),this._camera.updateMatrix(),this._camera.updateMatrixWorld(),this._renderer.render(this._scene,this._camera)},Object.defineProperty(t.prototype,"_htmlElements",{get:function(){return this._hotSpots.map(function(t){return t.element})},enumerable:!0,configurable:!0}),t}(),L=function(){function t(){}return t.addToClassList=function(t,e){for(var i=0;i<t.length;++i)t[i].classList.add(e)},t.removeFromClassList=function(t,e){for(var i=0;i<t.length;++i)t[i].classList.remove(e)},t.addListenerToHTMLElements=function(t,e,i){for(var n=0;n<t.length;++n)t[n].addEventListener(e,i)},t.removeListenerFromHTMLElements=function(t,e,i){for(var n=0;n<t.length;++n)t[n].removeEventListener(e,i)},t.addStyleToHTMLElements=function(t,e,i){for(var n=0;n<t.length;++n)t[n].style[e]=i},t.removeElementFromDom=function(t){t.parentElement&&t.parentElement.removeChild(t)},t.clearElement=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},t.hideElement=function(t){t.style.display="none"},t.showElement=function(t,e){void 0===e&&(e=!1),t.style.display=e?"block":""},t.isElementChildOfElement=function(t,e){return e.contains(t)},t.disableElement=function(t){t.classList.add("disabledPointerActions")},t.enableElement=function(t){t.classList.remove("disabledPointerActions")},t}(),F=function(){function t(){}return t.intersectSphere=function(e,i,n,r){var o=t.convertCameraPositionAndCursorToRay(e,i,n,r),a=o.origin,s=c.dotProduct(a,a)-1,h=c.dotProduct(o.direction,a),l=h*h-s,u=-h+Math.sqrt(Math.abs(l));return c.addVectors(o.origin,c.multiplyByScalar(o.direction,u))},t.convertCameraPositionAndCursorToRay=function(t,e,i,n){var r=l.WORLD_UP,o=c.normalize(c.crossVectors(t,r)),a=c.normalize(c.crossVectors(o,t)),s=c.multiplyByScalar(t,u.getForwardLengthFromFOV(l.FOV)*n),h=c.multiplyByScalar(c.multiplyByScalar(o,i),e[0]),d=c.multiplyByScalar(a,e[1]),p=c.addVectors(c.addVectors(s,h),d);return{origin:l.CAMERA_POSITION,direction:c.normalize(p)}},t}(),A=function(){function t(t,e,i){var n=this;this._desktopScale=.0011,this._mobileScale=1.35*this._desktopScale,this._timeoutId=-1,this._animationFrameId=-1,this.signals={click:m.create()},this.showThumbnail=function(){clearTimeout(n._timeoutId),cancelAnimationFrame(n._animationFrameId),n._thumbnail.style.display="block",n._animationFrameId=window.requestAnimationFrame(function(){n._thumbnail.style.opacity="1"})},this.hideThumbnail=function(){clearTimeout(n._timeoutId),cancelAnimationFrame(n._animationFrameId),requestAnimationFrame(function(){n._thumbnail.style.opacity=""}),n._timeoutId=window.setTimeout(function(){n._thumbnail.style.display=""},300)},this.onMouseDown=function(t){t.button===l.MOUSE_BUTTON.LEFT&&n.onPointerDown(t.clientX,t.clientY,t)},this.onTouchStart=function(t){t.preventDefault(),1===t.touches.length?n.onPointerDown(t.touches[0].clientX,t.touches[0].clientY,t):n.onPointerUp()},this.onMouseMove=function(t){n.onPointerMove(t.clientX,t.clientY,t)},this.onTouchMove=function(t){t.preventDefault(),1===t.touches.length?n.onPointerMove(t.touches[0].clientX,t.touches[0].clientY,t):n.onPointerUp()},this.onPointerUp=function(){n._pointer&&(performance.now()-n._pointer.downTimeStamp>l.clickThreshold.time&&(n._pointer.triggerClickOnPointerUp=!1),n._pointer.triggerClickOnPointerUp&&n.signals.click.dispatch(null)),n._pointer=null},this._id=e.id,this._longitude=e.longitude,this._latitude=e.latitude,this._photoSphere=t,this._sceneManager=i}return t.prototype.createObject3D=function(){this._element=document.createElement("div"),this._element.className="hotSpot",this._thumbnail=document.createElement("img"),this._thumbnail.src=this._photoSphere.preview,this._thumbnail.classList.add("thumbnail"),this._element.appendChild(this._thumbnail),this._labelContainer=document.createElement("div"),this._labelContainer.classList.add("vbox"),this._labelContainer.classList.add("labelContainer");var t=document.createElement("div");t.classList.add("icon"),this._labelContainer.appendChild(t),this._photoSphere.name&&(this._label=document.createElement("div"),this._label.textContent=this._photoSphere.name,this._label.classList.add("label"),this._labelContainer.appendChild(this._label)),this._labelContainer.addEventListener("mousemove",this.showThumbnail),this._labelContainer.addEventListener("mouseleave",this.hideThumbnail),this._element.appendChild(this._labelContainer),this._labelContainer.addEventListener("mousedown",this.onMouseDown),this._labelContainer.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("mouseup",this.onPointerUp),window.addEventListener("touchend",this.onPointerUp),window.addEventListener("touchcancel",this.onPointerUp);var e=u.getSphereSurfacePointFromUV(this._longitude,Math.PI/2-this._latitude);return this._object3D=new M(this._element),this._object3D.setOriginalPosition(e),this._object3D},t.prototype.getUVFromClientXY=function(t,e){var i=[window.innerWidth,window.innerHeight],n=u.getNormalizedCursorCoords(t,e,i),r=this._sceneManager.forward,o=F.intersectSphere(r,n,i[0]/i[1],this._sceneManager.userZoomFactor.value);return u.getUVFromSphereSufracePoint(o)},t.prototype.onPointerDown=function(t,e,i){if(i.preventDefault(),!this._pointer){var n=this.getUVFromClientXY(t,e),r=u.getSphereSurfacePointFromUV(2*(n[0]+.5)*Math.PI,(1-n[1])*Math.PI);this._pointer={startX:t,startY:e,clientX:t,clientY:e,hasHotSpotMoved:!1,startCursorToObject:c.subVectors(this._object3D.originalPosition,r),triggerClickOnPointerUp:!0,downTimeStamp:performance.now()}}},t.prototype.onPointerMove=function(t,e,i){if(this._pointer){this._pointer.clientX=t,this._pointer.clientY=e;var n=this._pointer.startX-t,r=this._pointer.startY-e;(l.clickThreshold.movement<Math.abs(n)||l.clickThreshold.movement<Math.abs(r))&&(this._pointer.triggerClickOnPointerUp=!1)}},t.prototype.resize=function(t){void 0===t&&(t=1);var e=t*(window.innerWidth<1e3?this._mobileScale:this._desktopScale),i=c.multiplyByScalar(this._object3D.originalPosition,1/e);this._object3D.setPosition(i)},t.prototype.destroy=function(){this._element&&(this.signals.click.removeAll(),this._object3D.parent&&this._object3D.parent.remove(this._object3D),this._labelContainer.removeEventListener("mousemove",this.showThumbnail),this._labelContainer.removeEventListener("mouseleave",this.hideThumbnail),this._labelContainer.removeEventListener("mousedown",this.onMouseDown),this._labelContainer.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onPointerUp),window.removeEventListener("touchend",this.onPointerUp),window.removeEventListener("touchcancel",this.onPointerUp),L.removeElementFromDom(this._element))},Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photoSphere",{get:function(){return this._photoSphere},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._longitude},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"latitude",{get:function(){return this._latitude},enumerable:!0,configurable:!0}),t}(),D=function(){function t(){var e=this;this._activeCss3DManagerIndex=1,this._forward=[0,0,-1],this._userZoomFactor=new p(l.DEFAULT_ZOOM_FACTOR,l.DEFAULT_ZOOM_FACTOR,l.MIN_ZOOM_FACTOR,4,h.EASE_OUT,l.TRANSITION_DURATION),this._isFirstTextureLoaded=!1,this.signals={resize:m.create(),tick:m.create(),webglNotSupported:m.create()},this.needsRender=!0,this.onContextLost=function(){e.signals.webglNotSupported.dispatch("contextLost")},this.onWindowResize=function(){var t=window.innerWidth,i=window.innerHeight;e._webGLRenderer.setSize(t,i),e._css3dManagers[0].setSize(t,i),e._css3dManagers[1].setSize(t,i),e._controls.setSize(),e.signals.resize.dispatch({width:t,height:i})},this.update=function(){e._isFirstTextureLoaded&&(t._timeStamp=performance.now(),t._deltaFrame=t._timeStamp-t.prevTimeStamp,t.prevTimeStamp=t._timeStamp,d.updateActiveOnes(t._timeStamp)&&(e._forward=e._controls.update(),e.needsRender=!0),e.needsRender&&(e._webGLRenderer.render(e._forward,e._userZoomFactor.value),e._css3dManagers[0].render(e._forward,e._userZoomFactor.value),e._css3dManagers[1].render(e._forward,e._userZoomFactor.value),e.needsRender=!1),e.signals.tick.dispatch(null))},this.animate=function(){e.update(),requestAnimationFrame(e.animate)},this._canvas=document.getElementById("myCanvas")}return t.prototype.init=function(){try{this.initRenderers(),this.initControls(),window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}catch(t){return!1}return!0},t.prototype.initRenderers=function(){this._webGLRenderer=new v(this._canvas,this),this._webGLRenderer.init(),this._canvas.addEventListener("webglcontextlost",this.onContextLost),this._css3dManagers=[new I(this._canvas,this),new I(this._canvas,this)]},t.prototype.initControls=function(){this._controls=new _(this._canvas.parentElement,this),this._controls.activate()},t.prototype.loadPhotoSphere=function(t,e,i,n,r,o){var a=this;this._photoSphereID=t,this._controls.limitRotation(e.viewBox),this._isFirstTextureLoaded&&this._controls.setHeadingAngle(isNaN(r)?e.headingAngle:r,i,this._isFirstTextureLoaded);var s=Math.max(l.MIN_ZOOM_FACTOR,425e-6*e.textureData.width/(e.viewBox[2]-e.viewBox[0]));s<this._userZoomFactor.value&&(i=!1),this._webGLRenderer.loadTexture(e,i),requestAnimationFrame(function(){a._userZoomFactor.setEnd(Math.min(a._userZoomFactor.end,s)),setTimeout(function(){a._userZoomFactor.setMax(s)},a._userZoomFactor.animationDuration)});var h=this._activeCss3DManagerIndex;this._activeCss3DManagerIndex=1===this._activeCss3DManagerIndex?0:1,this._css3dManagers[h].fade(),this._css3dManagers[this._activeCss3DManagerIndex].updateHotSpots(n.map(function(t){return new A(t.photoSphere,t,a)}),o,i),this.needsRender=!0,this._isFirstTextureLoaded=!0},Object.defineProperty(t,"timeStamp",{get:function(){return t._timeStamp},enumerable:!0,configurable:!0}),Object.defineProperty(t,"deltaFrame",{get:function(){return t._deltaFrame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userZoomFactor",{get:function(){return this._userZoomFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxTextureSize",{get:function(){return this._webGLRenderer.maxTextureSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"css3dManagers",{get:function(){return this._css3dManagers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photoSphereID",{get:function(){return this._photoSphereID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forward",{get:function(){return this._forward},enumerable:!0,configurable:!0}),t.prevTimeStamp=0,t._timeStamp=0,t._deltaFrame=1e3,t}(),U=function(){},R=function(){function t(){}return t.createWorker=function(t){return new Worker(URL.createObjectURL(new Blob(["("+t+")()"])))},t.getImage=function(e,i){var n=this;return"undefined"!=typeof createImageBitmap?new Promise(function(n,r){t.worker.addEventListener("message",function i(o){o.data.src===e&&(t.worker.removeEventListener("message",i),o.data.error&&r(o.data.error),n(o.data.bitmap))}),t.worker.postMessage({url:e,maxTextureSize:i})}):new Promise(function(r,s){return o(n,void 0,void 0,function(){var n,s,h,l,c,u=this;return a(this,function(d){switch(d.label){case 0:return[4,t.getImageElement(e)];case 1:return n=d.sent(),s=Math.max(n.width,n.height),i<s?(h=Math.min(s,i),l=n.width/n.height,c={width:null,height:null},l>=1?(c.width=h,c.height=c.width/l):(c.height=h,c.width=c.width*l),t._canvas.width=c.width,t._canvas.height=c.height,t._ctx.drawImage(n,0,0,c.width,c.height),t._canvas.toBlob(function(e){return o(u,void 0,void 0,function(){var i;return a(this,function(n){switch(n.label){case 0:return[4,t.getImageElement(URL.createObjectURL(e))];case 1:return i=n.sent(),r(i),[2]}})})})):r(n),[2]}})})})},t.getImageElement=function(e){return t._cache[e]||(t._cache[e]=new Promise(function(t,i){var n=document.createElement("img");n.setAttribute("crossorigin","anonymous"),n.onload=function(){t(n)},n.onerror=function(){i(n)},n.src=e})),t._cache[e]},t.getNewImageElement=function(t){return new Promise(function(e,i){var n=document.createElement("img");n.setAttribute("crossorigin","anonymous"),n.onload=function(){e(n)},n.onerror=function(){i(n)},n.src=t})},t.getImageForTexture=function(e,i,n){return o(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,t.getImage(e,n)];case 1:return[2,{textureData:r.sent(),viewBox:[0,.26944757609921083,1,.6344983089064261],headingAngle:i}]}})})},t._canvas=document.createElement("canvas"),t._ctx=t._canvas.getContext("2d"),t._cache={},t.worker=t.createWorker(function(){self.addEventListener("message",function(t){var e=t.data.url,i=t.data.maxTextureSize;fetch("https://soadzoor.github.io/virtual-tour_deploy/"+e).then(function(t){t.blob().then(function(t){createImageBitmap(t).then(function(t){var n=Math.max(t.width,t.height);if(i<n){var r=Math.min(n,i),o=t.width/t.height,a={width:null,height:null};o>=1?(a.width=r,a.height=a.width/o):(a.height=r,a.width=a.height*o),createImageBitmap(t,0,0,t.width,t.height,{resizeWidth:a.width,resizeHeight:a.height}).then(function(t){self.postMessage({src:e,bitmap:t},[t])})}else self.postMessage({src:e,bitmap:t},[t])})})})})}),t}(),C=function(){function t(){}return t.loadJSON=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,fetch(t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}})})},t}(),V=function(){function t(t,e){var i=this;this._imgCache={},this._urlParams=new URLSearchParams(window.location.search),this._numberOfPreloadedImages=5,this._isWebGLSupported=!0,this.loadPhotoSphere=function(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),new Promise(function(s,h){if(i._loadedPhotoSphereIndex!==t){i._loadedPhotoSphereIndex=t,L.removeFromClassList(i._container.children,"active"),i._container.children[t].classList.add("active");var l=i._photoSpheres[t],c=l.file;requestAnimationFrame(function(){return o(i,void 0,void 0,function(){var i,o,h,u,d,p,m,_,f,g=this;return a(this,function(a){switch(a.label){case 0:return r&&(this._loadingPage.classList.remove("hidden"),this._loadingPage.classList.remove("invisible")),i=D.timeStamp,[4,this.loadImage(c,l.headingAngle)];case 1:return o=a.sent(),h=performance.now(),clearTimeout(this._timeoutID),r&&(this._loadingPage.classList.add("invisible"),h-i<1e3?this._loadingPage.classList.add("hidden"):this._timeoutID=setTimeout(function(){g._loadingPage.classList.add("hidden")},1e3)),u=this._photoSpheres[t].transitions.map(function(t,e){return{photoSphere:g.getPhotoSphereFromID(t.toPanoramaId),latitude:t.latitude,longitude:t.longitude}}),this._sceneManager.loadPhotoSphere(this._photoSpheres[t].id,o,n,u,e,this.loadPhotoSphere),d=this._container.children[this._loadedPhotoSphereIndex],p=this._container.firstChild.scrollLeft,m=d.offsetLeft,_=window.innerWidth/2-d.offsetWidth/2,f=m+p-_,requestAnimationFrame(function(){g._userInterface.scrollTo(f),s(!0)}),[2]}})})})}})},this._sceneManager=t,this._userInterface=e,this._container=document.getElementById("imageList"),this._progressBar=document.getElementById("progressBar"),this._loadingPage=document.getElementById("loadingPage"),this._loadingBG=document.getElementById("loadingBG"),this._errorPage=document.getElementById("errorPage"),this._startTourPage=document.getElementById("startTourPage"),this._maxTextureSize=t.maxTextureSize}return t.prototype.preInit=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this._maxTextureSize?[4,this.init()]:[3,2];case 1:return t.sent(),[3,3];case 2:this._isWebGLSupported=!1,t.label=3;case 3:return[2]}})})},t.prototype.init=function(){return o(this,void 0,void 0,function(){var t,e=this;return a(this,function(i){switch(i.label){case 0:return(t="0"===this._urlParams.get("play"))||this._loadingPage.classList.remove("hidden"),[4,this.initBG()];case 1:return i.sent()&&(t?(this._startTourPage.classList.remove("hidden"),this._startTourPage.onclick=function(){e.initPhotoSpheres()}):this.initPhotoSpheres()),[2]}})})},t.prototype.initBG=function(){var t=this;return new Promise(function(e,i){return o(t,void 0,void 0,function(){var t,i=this;return a(this,function(n){switch(n.label){case 0:return[4,C.loadJSON("assets/config.json")];case 1:return(t=n.sent())?(this._loadingBG.style.backgroundImage="url("+t.preview+")",this._loadingBGTimeStamp=performance.now(),requestAnimationFrame(function(){requestAnimationFrame(function(){i._loadingBG.classList.remove("invisible"),i._photoSpheres=t.panoramas,i._sceneManager.css3dManagers[0].photoSpheres=i._photoSpheres,i._sceneManager.css3dManagers[1].photoSpheres=i._photoSpheres,console.log(i._photoSpheres),e(!0)})})):(this.showErrorPage("notfound"),e(!1)),[2]}})})})},t.prototype.initPhotoSpheres=function(){return o(this,void 0,void 0,function(){var t,e,i=this;return a(this,function(n){switch(n.label){case 0:return this._startTourPage.classList.add("hidden"),this._loadingPage.classList.remove("hidden"),[4,this.initThumbnails()];case 1:return n.sent(),[4,this.preloadImages(0,this._numberOfPreloadedImages,!0)];case 2:return n.sent(),[4,this.loadPhotoSphere(0,void 0,void 0,!1)];case 3:return n.sent(),t=performance.now(),e=t-this._loadingBGTimeStamp,setTimeout(function(){requestAnimationFrame(function(){i._loadingPage.classList.add("invisible"),i._loadingBG.classList.add("invisible"),setTimeout(function(){return o(i,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this._loadingPage.classList.add("hidden"),this._loadingPage.style.backgroundColor="rgba(25, 25, 25, .4)",this._progressBar.style.width="",this._progressBar.classList.add("cycle"),L.removeElementFromDom(this._loadingBG),[4,this.preloadImages(this._numberOfPreloadedImages,this._photoSpheres.length-this._numberOfPreloadedImages)];case 1:return t.sent(),[2]}})})},1e3),document.getElementById("scene").classList.remove("invisible")})},Math.max(1e3-e,0)),[2]}})})},t.prototype.showErrorPage=function(t,e){this._loadingPage.classList.add("hidden");var i=this._errorPage.querySelector(".vbox");if("notfound"===t)i.innerHTML="<h2>Tour not found</h2>";else if("unavailable"===t)i.innerHTML='<h2>Temporarily unavailable</h2>\n\t\t\t\t<p>Please try again later</p>\n\t\t\t\t<div id="reload" onclick="location.reload(true);" class="btn bigBtn flexCenter">RELOAD</div>';else if("unsupportedBrowser"===t){var n="contextLost"===e?'<h2>App has stopped</h2>\n\t\t\t\t<div onclick="location.reload(true);" class="btn bigBtn flexCenter">RELOAD</div>':"<h2>Sorry, your browser isn't supported</h2>\n\t\t\t\t<p>Please update it, or try another one.</p>";i.innerHTML=n}this._errorPage.classList.remove("hidden")},t.prototype.initThumbnails=function(){return o(this,void 0,void 0,function(){var t,e,i,n=this;return a(this,function(r){switch(r.label){case 0:t=function(t){var i,r,s,h;return a(this,function(l){switch(l.label){case 0:return i=e._photoSpheres[t],r=i.preview,(s=document.createElement("div")).className="photoSphere btn",s.setAttribute("data-label",i.name),[4,R.getNewImageElement(r)];case 1:return h=l.sent(),s.appendChild(h),s.onmousedown=s.ontouchstart=function(t){var e={x:t.clientX||t.touches[0].clientX,y:t.clientY||t.touches[0].clientY};s.pointerDown=e},s.onmouseup=s.ontouchend=function(e){return o(n,void 0,void 0,function(){var i,n;return a(this,function(r){switch(r.label){case 0:return(i=s.pointerDown)?(s.pointerDown=null,n={x:e.clientX||e.changedTouches[0].clientX,y:e.clientY||e.changedTouches[0].clientY},Math.abs(n.x-i.x)<3&&Math.abs(n.y-i.y)<3?[4,this.loadPhotoSphere(t)]:[3,2]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},e._container.appendChild(s),[2]}})},e=this,i=0,r.label=1;case 1:return i<this._photoSpheres.length?[5,t(i)]:[3,4];case 2:r.sent(),r.label=3;case 3:return++i,[3,1];case 4:return[2]}})})},t.prototype.loadImage=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this._imgCache[t]||(this._imgCache[t]=R.getImageForTexture(t,e,this._maxTextureSize)),[4,this._imgCache[t]];case 1:return[2,i.sent()];case 2:return i.sent(),this.showErrorPage("unavailable"),[3,3];case 3:return[2]}})})},t.prototype.preloadImages=function(t,e,i){return void 0===i&&(i=!1),o(this,void 0,void 0,function(){var n,r,o,s,h,l,c;return a(this,function(a){switch(a.label){case 0:n=[],r=Math.min(t+e,this._photoSpheres.length),0===t&&(this._progressBar.style.width="0%"),o=t,a.label=1;case 1:return o<r?((s=this._photoSpheres[o]).index=o,h=s.file,c=(l=n).push,[4,this.loadImage(h,s.headingAngle)]):[3,4];case 2:c.apply(l,[a.sent()]),i&&(this._progressBar.style.width=(o+1)/r*100+"%"),a.label=3;case 3:return++o,[3,1];case 4:return[2,n]}})})},t.prototype.getPhotoSphereIndexFromID=function(t){for(var e=0;e<this._photoSpheres.length;++e)if(this._photoSpheres[e].id===t)return e;return-1},t.prototype.getPhotoSphereFromID=function(t){var e=this.getPhotoSphereIndexFromID(t);return e>-1?this._photoSpheres[e]:null},Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWebGLSupported",{get:function(){return this._isWebGLSupported},enumerable:!0,configurable:!0}),t}(),B=function(){function t(t,e,i){var n=this;this.onBrowserNotSupported=function(t){n._imageList.showErrorPage("unsupportedBrowser",t)},this.setSize=function(){var t;null===(t=n._scrollLeft)||void 0===t||t.setMax(n.getMaxScrollLeft())},this.onTick=function(){n._scrollLeft&&(n._imageList.container.scrollLeft=n._scrollLeft.value)},this.toggleFullscreen=function(){var t=document;if(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)(t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen).call(document);else{var e=document.body;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}n._fullScreenToggler.classList.toggle("active");var i=n._fullScreenToggler.classList.contains("active")?"Exit":"Enter";n._fullScreenToggler.title=i+" Fullscreen"},this._sceneManager=t,this._main=e,this._imageListToggler=document.getElementById("imageListToggler"),this._fullScreenToggler=document.getElementById("fullscreenToggler"),this._menu=document.getElementById("menu"),this.preInit(i)}return t.prototype.preInit=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return t?(this._imageList=new V(this._sceneManager,this),[4,this._imageList.preInit()]):[3,2];case 1:return e.sent(),this._imageList.isWebGLSupported?(this.init(),this._main.signals.ready.dispatch(null)):this.onBrowserNotSupported(),[3,3];case 2:this.onBrowserNotSupported(),e.label=3;case 3:return[2]}})})},t.prototype.getBrowser=function(){return-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Chrome")?navigator.platform.indexOf("Mac")>-1?"Chrome - Mac":"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"IE":void 0},t.prototype.getMaxScrollLeft=function(){return this._imageList.container.scrollWidth-this._imageList.container.clientWidth},t.prototype.scrollTo=function(t){this.createScrollLeftIfNeeded(),this._scrollLeft.setEnd(t,!1)},t.prototype.createScrollLeftIfNeeded=function(){this._scrollLeft||(this._scrollLeft=new p(this._imageList.container.scrollLeft,this._imageList.container.scrollLeft,0,this.getMaxScrollLeft(),h.EASE_OUT,l.TRANSITION_DURATION,!1))},t.prototype.init=function(){var t=this;window.oncontextmenu=function(t){return t.preventDefault(),!1},this._sceneManager.signals.webglNotSupported.add(this.onBrowserNotSupported),this._sceneManager.signals.resize.add(this.setSize),this._sceneManager.signals.tick.add(this.onTick),l.isFullscreenAvailable?this._fullScreenToggler.addEventListener("click",this.toggleFullscreen):this._fullScreenToggler.classList.add("hidden"),this._imageListToggler.addEventListener("click",function(){t._imageListToggler.classList.toggle("up"),t._menu.classList.toggle("closed");var e=t._imageListToggler.classList.contains("up")?"Open":"Close";t._imageListToggler.title=e+" Menu"});var e=this.getBrowser();this._imageList.container.addEventListener("wheel",function(i){i.preventDefault(),t.createScrollLeftIfNeeded();var n=Math.abs(i.deltaX),r=Math.abs(i.deltaY),o=n>0,a=o?n:r,s=o?i.deltaX:i.deltaY,h=o;switch(e){case"Safari":case"Chrome - Mac":h=h||s%1==0&&a<100&&a%120!=0;break;case"Chrome":h=h||a%100!=0&&a%120!=0;break;case"Firefox":h=h||s%1!=0}console.log(h);var l=h?a:75;t._scrollLeft.increaseEndBy(Math.sign(s)*l,!0)}),this._imageList.container.addEventListener("touchstart",function(e){var i;(null===(i=t._scrollLeft)||void 0===i?void 0:i.isPlaying())||(t._scrollLeft=null)})},t}();i.d(e,"Main",function(){return j});var j=function(){function t(){var e=this;this.signals={ready:m.create()},this.startAnimating=function(){e._sceneManager.animate()},t.instance=this,this._model=new U,this._sceneManager=new D;var i=this._sceneManager.init();i&&this.signals.ready.add(this.startAnimating),this._ui=new B(this._sceneManager,this,i)}return t.getInstance=function(){return t.instance||new t},Object.defineProperty(t.prototype,"scene",{get:function(){return this._sceneManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t}();j.getInstance()}]);